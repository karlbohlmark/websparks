<!DOCTYPE HTML>
<html>
<head>
  <script>require = {define: function(){}}</script>
<script src="script/lib/jquery.js"></script>

<script>
ns = {
  svg: 'http://www.w3.org/2000/svg'
}

var lastRect = null

var rects = []

var createCircle = function(x, y, radius, color){
  var circle = document.createElementNS(ns.svg, 'circle')
  circle.setAttributeNS(null, "cx", x);
  circle.setAttributeNS(null, "cy", y);
  circle.setAttributeNS(null, "r", radius);
  circle.setAttributeNS(null, "fill", color);
  return circle;
}

var createRectangle = function(x, y, width, height, color){
  var rect = document.createElementNS(ns.svg, 'rect')
  console.log(x)
  console.log(y)
  
  var attrs = {
    "x": x-width/2,
    "y": y - height/2,
    "rx": 20,
    "ry": 20,
    "width": width,
    "height": height,
    "fill": '#efefef',
    "stroke": color,
    "stroke-width": '5',
    "opacity": '0.7'
  }
  
  for(attr in attrs){
    rect.setAttributeNS(null, attr, attrs[attr])
  }
  rects.push(rect)
  return rect;
}

function drag(element){
  document.onmousemove = function(ev){
    element.setAttributeNS(null, "x", ev.x - element.attributes.width.value/2)
    element.setAttributeNS(null, "y", ev.y - element.attributes.height.value/2)
  }
  document.onmouseup = function(ev){
    document.onmousemove = null
  }
}

function createBezierSegment(start, control, stop){
  var bezierPath = document.createElementNS(ns.svg, 'path')
  bezierPath.)
}

$(function(){
  
  
  var svgstuff =$('#svgelem')
  
  var svgElem = document.getElementById('svgelem')
  
  var points = []
  
  svgElem.addEventListener('mousedown', function(e){
    
    var rect
    /*
    if(e.target.toString().toUpperCase().match(/RECT/)==null)
    {
      rect = createRectangle(e.pageX, e.pageY, 200, 140, 'black')
      rect.style.cursor = 'pointer'
      svgstuff.append(rect)
    }else{
      drag(e.target)
    }
    */
    
    if(points.length<3){
      points.push({x:e.pageX, y: e.pageY})
    }else{
      createBezierSegment.apply({},points)
    }
  }, false);
  
  
  
})
</script>
</head>
<body>
  <div id="divwithsvg">
    <svg id="svgelem" zoomAndPan="magnify" height="800" xmlns="http://www.w3.org/2000/svg">
    </svg>
  </div>
  
</body>
</html>